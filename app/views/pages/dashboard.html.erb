<div class="well" id="profile" style="display: none;">
    <img id="logo" />
    <div id="fullName"></div>
    <div id="badges"></div>
</div>

<div class="well" id="journal" style="display: none;">
    <div id="steps"></div>
</div>

<script>
    if (!access_token)
        window.location.href = "/";

    jQuery.ajax( {
        url: 'https://api.fitbit.com/1/user/-/profile.json',
        type: 'GET',
        beforeSend : function(xhr) {
            xhr.setRequestHeader( 'Authorization', 'Bearer ' + access_token );
        },
        success: function(response) {
            $('#logo').attr("src", response.user.avatar);
            $('#fullName').text(response.user.fullName);

            var badges = "";
            $.each(response.user.topBadges, function(index, badge) {
                badges += "<img src='" + badge.image100px + "' />";
                badges += "<div>" + badge.description + "</div>";
                badges += "<div>" + badge.shareText + "</div>";
            });
            $('#badges').html(badges);

            //$('#profile').html(JSON.stringify(response.user.avatar));
        }
    });
    jQuery.ajax( {
        url: 'https://api.fitbit.com/1/user/-/activities/steps/date/today/1m.json',
        type: 'GET',
        beforeSend : function(xhr) {
            xhr.setRequestHeader( 'Authorization', 'Bearer ' + access_token );
        },
        success: function(response) {
            var steps = "";
            $.each(response["activities-steps"], function(index, step) {
                if (step.value > 0) {
                    steps += "<div>" + step.dateTime + "</div>";
                    steps += "<div>" + step.value + "</div>";
                }
            });
            $('#steps').html(steps);
        }
    });
</script>
